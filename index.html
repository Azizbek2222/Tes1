<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<title>HTML olish</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0f172a;
    color: #e5e7eb;
}

.container {
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
}

h1 {
    text-align: center;
    margin-bottom: 20px;
    color: #38bdf8;
}

.input-box {
    display: flex;
    gap: 10px;
}

input {
    flex: 1;
    padding: 12px;
    border-radius: 8px;
    border: none;
    outline: none;
    font-size: 15px;
}

button {
    padding: 12px 18px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    font-weight: bold;
}

#get {
    background: #22c55e;
    color: #022c22;
}

#copy {
    background: #38bdf8;
    color: #022c22;
    margin-top: 10px;
}

#copy:active {
    transform: scale(0.97);
}

.code-box {
    margin-top: 20px;
    background: #020617;
    border-radius: 10px;
    padding: 15px;
    overflow: auto;
    max-height: 450px;
    font-family: Consolas, monospace;
    font-size: 14px;
    white-space: pre;
}

/* Syntax highlight */
.tag { color: #38bdf8; }
.attr { color: #facc15; }
.value { color: #4ade80; }
.text { color: #e5e7eb; }

.footer {
    text-align: center;
    margin-top: 15px;
    font-size: 13px;
    opacity: 0.7;
}
</style>
</head>
<body>

<div class="container">
    <h1>HTML olish</h1>

    <div class="input-box">
        <input id="url" placeholder="Sayt linkini kiriting...">
        <button id="get" onclick="loadHTML()">Olish</button>
    </div>

    <button id="copy" onclick="copyHTML()">ðŸ“‹ Kodni nusxalash</button>

    <div id="result" class="code-box">Bu yerda HTML kodi chiqadi...</div>

    <div class="footer">
        HTML Parser â€¢ PHP server orqali
    </div>
</div>

<script>
function loadHTML() {
    let url = document.getElementById("url").value;
    document.getElementById("result").textContent = "Yuklanmoqda...";

    fetch("http://10.2.40.111:45267/gethtml.php?url=" + encodeURIComponent(url))
        .then(r => r.text())
        .then(data => {
            document.getElementById("result").innerHTML = highlightHTML(data);
            window.rawHTML = data;
        })
        .catch(() => {
            document.getElementById("result").textContent = "Xatolik yuz berdi";
        });
}

/* ðŸ”§ TUZATILGAN COPY FUNKSIYA (HTTP DA HAM ISHLAYDI) */
function copyHTML() {
    if (!window.rawHTML) {
        alert("Avval HTML oling");
        return;
    }

    let textarea = document.createElement("textarea");
    textarea.value = window.rawHTML;
    document.body.appendChild(textarea);
    textarea.select();
    textarea.setSelectionRange(0, 999999);

    document.execCommand("copy");
    document.body.removeChild(textarea);

    alert("HTML kodi nusxalandi");
}

function highlightHTML(code) {
    return code
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/(&lt;\/?)([a-zA-Z0-9\-]+)/g, '$1<span class="tag">$2</span>')
        .replace(/([a-zA-Z-]+)=(".*?")/g, '<span class="attr">$1</span>=<span class="value">$2</span>');
}
</script>

</body>
</html>